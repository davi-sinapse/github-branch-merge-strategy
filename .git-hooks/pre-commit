#!/bin/bash

while read oldrev newrev refname; do
    # Extract the branch name from the refname
    branch_name=${refname#refs/heads/}

    # List of blocked branches
    blocked_branches=("main" "staging")

    # Check if the pushed branch is blocked
    if [[ "${blocked_branches[@]}" =~ "$branch_name" ]]; then
        echo "Merging into $branch_name is not allowed."
        exit 1
    fi
done